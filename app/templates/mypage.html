{% extends "base.html" %}

{% block title %}マイページ{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ようこそ、{{ user.full_name }} さん！</h1>
</div>

<!-- 生徒用のアクションリンク -->
{% if user.role == 'student' %}
    <a href="{{ url_for('portfolio_create') }}" class="btn btn-success">ポートフォリオ作成</a>
    <!-- 既存の編集リンクは詳細ページからアクセスするため削除 -->
{% endif %}

<!-- 投稿済みポートフォリオの一覧表示 -->
<h3 style="margin-top: 30px;">あなたのポートフォリオ一覧</h3>
{% if portfolios %}
    <ul class="list-group">
        {% for portfolio in portfolios %}
            <li class="list-group-item">
                <h4>
                    <a href="{{ url_for('portfolio_detail', portfolio_id=portfolio.id) }}">{{ portfolio.title }}</a>
                </h4>
                <p>{{ portfolio.type_label }}</p>

                <!-- フィードバックの表示 -->
                <h5>フィードバック:</h5>
                {% if portfolio.feedbacks %}
                    <ul>
                        {% for feedback in portfolio.feedbacks %}
                            <li>{{ feedback.feedback }} - 先生: {{ feedback.teacher_name }}</li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p>フィードバックはまだありません。</p>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>まだポートフォリオが投稿されていません。</p>
{% endif %}

<a href="{{ url_for('index') }}" class="btn btn-default" style="margin-top: 20px;">ホームに戻る</a>
{% endblock %}
